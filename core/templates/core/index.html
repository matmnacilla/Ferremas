<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Ferremas - Tu tienda de ferretería</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
  <style>
    /* Estilos para el carrusel */
    .carousel-item {
      height: 400px;
      background-size: cover;
      background-position: center;
    }

    .carousel-item .container {
      position: relative;
      z-index: 2;
    }

    .carousel-item::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: rgba(0, 0, 0, 0.3);
      z-index: 1;
    }

    .carousel-item .display-4 {
      text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.3);
    }

    .carousel-item .lead {
      text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.3);
    }

    .carousel-control-prev,
    .carousel-control-next {
      width: 5%;
    }

    .carousel-indicators {
      margin-bottom: 1rem;
    }

    .carousel-indicators button {
      width: 12px;
      height: 12px;
      border-radius: 50%;
      margin: 0 5px;
    }

    /* Responsive */
    @media (max-width: 768px) {
      .carousel-item {
        height: 300px;
      }

      .carousel-item .display-4 {
        font-size: 2rem;
      }

      .carousel-item .lead {
        font-size: 1rem;
      }
    }
  </style>
</head>
<body style="background-color: #F5F5F5;">

  <nav class="navbar navbar-expand-lg navbar-dark bg-dark">
    <div class="container">
      <a class="navbar-brand" href="#">
        <i class="bi bi-tools me-2"></i>
        Ferremas
      </a>
      {% if user.is_authenticated %}
      <!-- Usuario autenticado -->
      <span class="navbar-text text-light">
        Bienvenido, {{ user.username }}
      </span>
      {% endif %}
      <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
        <span class="navbar-toggler-icon"></span>
      </button>
      
      <div class="collapse navbar-collapse" id="navbarNav">
        <ul class="navbar-nav ms-auto">
          <li class="nav-item"><a class="nav-link active" href="#">Inicio</a></li>
          <li class="nav-item"><a class="nav-link" href="{% url 'catalogo' %}">Productos</a></li>
      
          {% if not user.is_authenticated %}  
           <!-- Usuario no autenticado -->
           <li class="nav-item"><a class="nav-link" href="{% url 'login' %}">Iniciar sesión</a></li>
           <li class="nav-item"><a class="nav-link" href="{% url 'registrarse' %}">Registrarse</a></li>
          {% else %}
          <!-- Usuario autenticado -->
          <li class="nav-item">
            <a class="nav-link" href="{% url 'logout' %}">Cerrar sesión</a>
          </li>
          {% endif %}
        </ul>
      </div>
    </div>
  </nav>

  <!-- Carrusel -->
  <div id="carouselMain" class="carousel slide" data-bs-ride="carousel">
    <!-- Indicadores -->
    <div class="carousel-indicators">
      <button type="button" data-bs-target="#carouselMain" data-bs-slide-to="0" class="active"></button>
      <button type="button" data-bs-target="#carouselMain" data-bs-slide-to="1"></button>
      <button type="button" data-bs-target="#carouselMain" data-bs-slide-to="2"></button>
      <button type="button" data-bs-target="#carouselMain" data-bs-slide-to="3"></button>
    </div>

    <!-- Slides -->
    <div class="carousel-inner">
      <!-- Slide 1: Bienvenida -->
      <div class="carousel-item active">
        <div class="bg-primary text-white py-5" style="height: 400px;">
          <div class="container h-100 d-flex align-items-center">
            <div class="row">
              <div class="col-md-8">
                <h1 class="display-4 fw-bold">Bienvenido a Ferremas</h1>
                <p class="lead">Tu ferretería de confianza. Todo lo que necesitas para tus proyectos de construcción, hogar o industria.</p>
                <a href="{% url 'catalogo' %}" class="btn btn-light btn-lg">Explora nuestros productos</a>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Slide 2: Herramientas -->
      <div class="carousel-item">
        <div class="bg-danger text-white py-5" style="height: 400px;">
          <div class="container h-100 d-flex align-items-center">
            <div class="row">
              <div class="col-md-8">
                <h2 class="display-4 fw-bold">Herramientas Profesionales</h2>
                <p class="lead">Amplia selección de herramientas de las mejores marcas para profesionales y aficionados.</p>
                <a href="{% url 'catalogo' %}" class="btn btn-light btn-lg">Ver herramientas</a>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Slide 3: Materiales -->
      <div class="carousel-item">
        <div class="bg-success text-white py-5" style="height: 400px;">
          <div class="container h-100 d-flex align-items-center">
            <div class="row">
              <div class="col-md-8">
                <h2 class="display-4 fw-bold">Materiales de Construcción</h2>
                <p class="lead">Todo tipo de materiales para tus proyectos de construcción y remodelación.</p>
                <a href="{% url 'catalogo' %}" class="btn btn-light btn-lg">Ver materiales</a>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Slide 4: Ofertas -->
      <div class="carousel-item">
        <div class="bg-warning text-dark py-5" style="height: 400px;">
          <div class="container h-100 d-flex align-items-center">
            <div class="row">
              <div class="col-md-8">
                <h2 class="display-4 fw-bold">Ofertas Especiales</h2>
                <p class="lead">Aprovecha nuestras ofertas y descuentos en productos seleccionados.</p>
                <a href="{% url 'catalogo' %}?ofertas=true" class="btn btn-dark btn-lg">Ver ofertas</a>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Controles -->
    <button class="carousel-control-prev" type="button" data-bs-target="#carouselMain" data-bs-slide="prev">
      <span class="carousel-control-prev-icon"></span>
      <span class="visually-hidden">Anterior</span>
    </button>
    <button class="carousel-control-next" type="button" data-bs-target="#carouselMain" data-bs-slide="next">
      <span class="carousel-control-next-icon"></span>
      <span class="visually-hidden">Siguiente</span>
    </button>
  </div>

  <!-- Productos Destacados -->
  <div class="container mb-5">
    <h2 class="mb-4 text-center">Productos Destacados</h2>
    <div class="row row-cols-1 row-cols-md-3 g-4">
      {% for producto in productos_destacados %}
      <div class="col">
        <div class="card h-100">
          {% if producto.imagen %}
          <img src="{{ producto.imagen.url }}" class="card-img-top" alt="{{ producto.nombre }}" style="height: 200px; object-fit: cover;">
          {% else %}
          <div class="card-img-top bg-light d-flex align-items-center justify-content-center" style="height: 200px;">
            <i class="bi bi-tools" style="font-size: 4rem; color: #6c757d;"></i>
          </div>
          {% endif %}
          <div class="card-body">
            <h5 class="card-title">{{ producto.nombre }}</h5>
            <p class="card-text">{{ producto.descripcion|truncatechars:100 }}</p>
          </div>
          <div class="card-footer d-flex justify-content-between align-items-center">
            <div>
              {% if producto.precio_oferta %}
              <small class="text-muted text-decoration-line-through">${{ producto.precio|floatformat:0 }}</small>
              <span class="ms-2 fw-bold text-danger">${{ producto.precio_oferta|floatformat:0 }}</span>
              <span class="badge bg-danger ms-2">-{{ producto.porcentaje_descuento }}%</span>
              {% else %}
              <span class="fw-bold">${{ producto.precio|floatformat:0 }}</span>
              {% endif %}
            </div>
            <a href="{% url 'detalle_producto' producto.id %}" class="btn btn-primary btn-sm">Ver detalles</a>
          </div>
        </div>
      </div>
      {% empty %}
      <div class="col-12 text-center">
        <p class="text-muted">No hay productos destacados disponibles en este momento.</p>
      </div>
      {% endfor %}
    </div>
  </div>

  <!-- Footer -->
  <footer class="bg-dark text-white text-center py-4">
    <p class="mb-1">&copy; 2025 Ferremas. Todos los derechos reservados.</p>
    <p class="mb-0">Contacto: contacto@ferremas.com | Tel: 59 2 1234 5678</p>
  </footer>

  <!-- Bootstrap JS -->
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>

  <!-- Agregar esto temporalmente en index.html para debug -->
  <div style="display: none;">
    Debug info:
    Usuario autenticado: {{ user.is_authenticated }}
    Username: {{ user.username }}
    Email: {{ user.email }}
    Grupos: {{ user.groups.all }}
  </div>
</body>
</html>
